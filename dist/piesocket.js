var PieSocket;(()=>{var n={502:(n,e,o)=>{"use strict";o.d(e,{default:()=>r});class t{constructor(n){this.options=n}log(...n){this.options.consoleLogs&&console.log(...n)}warn(...n){this.options.consoleLogs&&console.warn(...n)}error(...n){this.options.consoleLogs&&console.error(...n)}}class s{constructor(n,e){this.endpoint=n,this.identity=e,this.connection=this.connect(),this.events={},this.shouldReconnect=!1,this.logger=new t(e)}connect(){var n=new WebSocket(this.endpoint);return n.onmessage=this.onMessage.bind(this),n.onopen=this.onOpen.bind(this),n.onerror=this.onError.bind(this),n.onclose=this.onClose.bind(this),n}on(n,e){this.events[n]=e}send(n){return this.connection.send(n)}onMessage(n){this.logger.log("Channel message:",n);try{JSON.parse(n.data).error.length&&(this.shouldReconnect=!1)}catch(n){}this.events.message&&this.events.message.bind(this)(n)}onOpen(n){this.logger.log("Channel connected:",n),this.shouldReconnect=!0,this.events.open&&this.events.open.bind(this)(n)}onError(n){this.logger.error("Channel error:",n),this.connection.close(),this.events.error&&this.events.error.bind(this)(n)}onClose(n){this.logger.warn("Channel closed:",n),this.reconnect(),this.events.close&&this.events.close.bind(this)(n)}reconnect(){this.shouldReconnect&&(this.logger.log("Reconnecting"),this.connect())}}const i={version:3,clusterId:"demo",apiKey:"oCdCMcMPQpbvNjUIzqtvF1d2X2okWpDQj4AwARJuAgtjhzKxVEjQU6IdCjwm",consoleLogs:!1,notifySelf:!0};class r{constructor(n){n=n||{},this.options={...i,...n},this.connections={},this.logger=new t(this.options)}subscribe(n){var e=this.getEndpoint(n);if(this.connections[n])return this.logger.log("Returning existing channel",e),this.connections[n];this.logger.log("Creating new channel",e);var o=new s(e,{channelId:n,...this.options});return this.connections[n]=o,o}unsubscribe(n){return!!this.connections[n]&&(this.connections[n].shouldReconnect=!1,this.connections[n].connection.close(),delete this.connections[n],!0)}getConnections(){return this.connections}getEndpoint(n){return`wss://${this.options.clusterId}.piesocket.com/v${this.options.version}/${n}?api_key=${this.options.apiKey}&notify_self=${this.options.notifySelf}&source=jssdk&v=1.1.0`}}},138:(n,e,o)=>{n.exports=o(502).default}},e={};function o(t){var s=e[t];if(void 0!==s)return s.exports;var i=e[t]={exports:{}};return n[t](i,i.exports,o),i.exports}o.d=(n,e)=>{for(var t in e)o.o(e,t)&&!o.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},o.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var t=o(138);PieSocket=t})();