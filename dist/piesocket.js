var PieSocket;(()=>{var n={502:(n,e,t)=>{"use strict";t.d(e,{default:()=>r});class o{constructor(n){this.options=n}log(...n){this.options.consoleLogs&&console.log(...n)}warn(...n){this.options.consoleLogs&&console.warn(...n)}error(...n){this.options.consoleLogs&&console.error(...n)}}class s{constructor(n,e){this.endpoint=n,this.identity=e,this.connection=this.connect(),this.events={},this.shouldReconnect=!1,this.logger=new o(e)}connect(){var n=new WebSocket(this.endpoint);return n.onmessage=this.onMessage.bind(this),n.onopen=this.onOpen.bind(this),n.onerror=this.onError.bind(this),n.onclose=this.onClose.bind(this),n}on(n,e){this.events[n]=e}send(n){return this.connection.send(n)}onMessage(n){this.logger.log("Channel message:",n);try{JSON.parse(n.data).error.length&&(this.shouldReconnect=!1)}catch(n){}this.events.message&&this.events.message.bind(this)(n)}onOpen(n){this.logger.log("Channel connected:",n),this.shouldReconnect=!0,this.events.open&&this.events.open.bind(this)(n)}onError(n){this.logger.error("Channel error:",n),this.connection.close(),this.events.error&&this.events.error.bind(this)(n)}onClose(n){this.logger.warn("Channel closed:",n),this.reconnect(),this.events.close&&this.events.close.bind(this)(n)}reconnect(){this.shouldReconnect&&(this.logger.log("Reconnecting"),this.connect())}}const i={version:3,clusterId:"demo",apiKey:"oCdCMcMPQpbvNjUIzqtvF1d2X2okWpDQj4AwARJuAgtjhzKxVEjQU6IdCjwm",consoleLogs:!1,notifySelf:!0,jwt:null};class r{constructor(n){n=n||{},this.options={...i,...n},this.connections={},this.logger=new o(this.options)}subscribe(n){var e=this.getEndpoint(n);if(this.connections[n])return this.logger.log("Returning existing channel",e),this.connections[n];this.logger.log("Creating new channel",e);var t=new s(e,{channelId:n,...this.options});return this.connections[n]=t,t}unsubscribe(n){return!!this.connections[n]&&(this.connections[n].shouldReconnect=!1,this.connections[n].connection.close(),delete this.connections[n],!0)}getConnections(){return this.connections}getEndpoint(n){let e=`wss://${this.options.clusterId}.piesocket.com/v${this.options.version}/${n}?api_key=${this.options.apiKey}&notify_self=${this.options.notifySelf}&source=jssdk&v=1.1.1`;return this.options.jwt&&(e=e+"&jwt="+this.options.jwt),e}}},138:(n,e,t)=>{n.exports=t(502).default}},e={};function t(o){var s=e[o];if(void 0!==s)return s.exports;var i=e[o]={exports:{}};return n[o](i,i.exports,t),i.exports}t.d=(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var o=t(138);PieSocket=o})();